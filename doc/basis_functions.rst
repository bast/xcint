

Evaluation of basis functions
=============================


Cartesian to spherical transformation
-------------------------------------

The basis functions are computed as Cartesian Gaussians
and then transformed to spherical Gaussians.
Expressions for the transformation of Cartesian
to pure spherical harmonic Gaussians can be found for instance in
`[IJQC 54, 83 (1995)] <http://dx.doi.org/10.1002/qua.560540202>`_.

The transformation matrices are automatically generated by
src/density/cs_trans.py.
The transformation is performed directly in build/generated/autogenerated_*.cpp
(search for vec_daxpy).


Screening
---------

Screening of the basis function shells is controlled via calls
to calculate_chunk which figures out whether the shell batch
is computed or not based on an estimated shell extent:

.. code-block:: c++

  // screening
  if (not calculate_chunk(extent_squared, p2)) continue;
